{% set tool_user = tool ~ '_tool_user' %}
{% set tool_role = tool ~ '_tool' %}
{% set tool_warehouse = tool ~ '_wh' %}

users:
  - name: {{ tool_user }}
    properties:
      default_role: {{ tool_role }}
      default_warehouse: {{ tool_warehouse }}
      type: service
      rsa_public_key: |
        -----BEGIN PUBLIC KEY-----
        MIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEA8apBpcFY4t0QsiJ7e125
        b8z+T4gPxdIY4A8BlNvNC+jf/0LaCDL4Jm1TkmCW9+pCZwZNlPs3nJ4apm4iQVYh
        3EiwI+i4DskSPy4xhowxoeaz6VU5i1faA6UgxW2F3jy6DfRuy6zdBPVnMPfiNmOh
        Z3KMtka8S6IBcITJSBRX1yzC7H5KCaiRHrMJuBOP42MR3ebxlcH6LoRsw+rz4cwz
        pqCFXK3jcoB5btz9MjbCPDx9/K6uPBgVQlOYBi4DSEn8fmrfopSComQ+okqzNl23
        el94QGHdSYNXFnx30tzW7iFbEfnB28+RZjxbQGng6+3aFG2/7yOcZkATJ6cTpxne
        twIDAQAB
        -----END PUBLIC KEY-----
roles:
  - name: {{ tool_role }}
warehouses: 
  - name: {{tool}}
    destroy: true
    properties:
      warehouse_size: xsmall
      auto_suspend: 60
      initially_suspended: true
  - name: {{ tool_warehouse }}
    properties:
      warehouse_size: xsmall
      auto_suspend: 60
      initially_suspended: true
privilegeGrants:
  - objectType: warehouse
    objectName: {{ tool_warehouse }}
    roleName: {{ tool_role }}
    grantOption: true
    privilege:
      - modify
      - monitor
      - operator
      - usage
  - objectType: database
    objectName: snowflake
    roleName: {{ tool_role }}
    privilege: imported privileges
roleGrants:
  - name: {{ tool_role }}
    toUsers: 
      - {{ tool_user }}
